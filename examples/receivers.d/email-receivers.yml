# ============================================================================
# EMAIL RECEIVERS - CONFIGURA√á√ÉO MODULAR
# ============================================================================
# Este arquivo cont√©m configura√ß√µes espec√≠ficas para receivers de email,
# organizados por equipe, severidade e tipo de alerta.
#
# NOTA: O Alertmanager n√£o suporta includes nativamente para receivers.
# Este arquivo serve como refer√™ncia para implementa√ß√£o via:
# - Ferramentas de templating (Helm, Ansible, Jinja2)
# - Scripts de deployment que concatenam arquivos
# - Ferramentas de CI/CD que processam configura√ß√µes modulares
# ============================================================================

# ========================================
# CONFIGURA√á√ïES EMAIL GLOBAIS
# ========================================
# Vari√°veis de ambiente necess√°rias:
# - SMTP_SMARTHOST: Servidor SMTP (ex: smtp.company.com:587)
# - SMTP_FROM: Email remetente (ex: alertmanager@company.com)
# - SMTP_AUTH_USERNAME: Usu√°rio SMTP
# - SMTP_AUTH_PASSWORD: Senha SMTP
#
# Listas de email por equipe:
# - SRE_EMAIL_LIST: sre-team@company.com,sre-oncall@company.com
# - DEV_EMAIL_LIST: dev-team@company.com,tech-leads@company.com
# - NETWORK_EMAIL_LIST: network-team@company.com,network-oncall@company.com
# - DBA_EMAIL_LIST: dba-team@company.com,database-admins@company.com
# - SECURITY_EMAIL_LIST: security-team@company.com,ciso@company.com

# ========================================
# RECEIVERS EMAIL - PADR√ÉO
# ========================================

# Notifica√ß√µes padr√£o
default-notifications-email:
  email_configs:
    - to: 'ops-team@company.com'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[ALERT] {{ .GroupLabels.alertname }} - {{ .GroupLabels.severity }}'
      body: |
        Alerta detectado no sistema de monitoramento.
        
        ===== RESUMO DO ALERTA =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Prioridade: {{ .Labels.priority | default "P2" }}
        Inst√¢ncia: {{ .Labels.instance }}
        Servi√ßo: {{ .Labels.service | default "N/A" }}
        Equipe: {{ .Labels.team | default "ops" }}
        Ambiente: {{ .Labels.environment | default "unknown" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        {{ if .Annotations.alert_id }}
        Alert ID: {{ .Annotations.alert_id }}
        {{ end }}
        
        {{ end }}
        ===== LINKS √öTEIS =====
        - Prometheus: http://prometheus.company.com
        - Grafana: http://grafana.company.com
        - Alertmanager: http://alertmanager.company.com
        
        Este √© um email autom√°tico do sistema de monitoramento.
      headers:
        Subject: '[ALERT] {{ .GroupLabels.alertname }}'
        X-Priority: '{{ if eq .GroupLabels.severity "critical" }}1{{ else if eq .GroupLabels.severity "warning" }}3{{ else }}5{{ end }}'
        X-Mailer: 'Alertmanager'

# ========================================
# RECEIVERS EMAIL - CR√çTICOS
# ========================================

# Alertas cr√≠ticos gerais
critical-alerts-email:
  email_configs:
    - to: 'critical-alerts@company.com,sre-oncall@company.com,ops-manager@company.com'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: 'üî¥ CRITICAL ALERT: {{ .GroupLabels.alertname }} - {{ .GroupLabels.instance }}'
      body: |
        ‚ö†Ô∏è  ALERTA CR√çTICO DETECTADO ‚ö†Ô∏è
        
        Um alerta cr√≠tico foi disparado e requer aten√ß√£o IMEDIATA.
        
        ===== DETALHES DO ALERTA CR√çTICO =====
        {{ range .Alerts }}
        üö® Alert: {{ .Annotations.summary }}
        üìù Descri√ß√£o: {{ .Annotations.description }}
        üî• Severidade: {{ .Labels.severity | upper }}
        ‚ö° Prioridade: {{ .Labels.priority | default "P1" }}
        üñ•Ô∏è  Inst√¢ncia: {{ .Labels.instance }}
        üîß Servi√ßo: {{ .Labels.service | default "N/A" }}
        üë• Equipe Respons√°vel: {{ .Labels.team | default "ops" }}
        üåç Ambiente: {{ .Labels.environment | default "unknown" }}
        ‚è∞ Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        ‚è±Ô∏è  Dura√ß√£o: {{ .StartsAt | since }}
        {{ if .Annotations.runbook_url }}
        üìñ Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        {{ if .Annotations.alert_id }}
        üÜî Alert ID: {{ .Annotations.alert_id }}
        {{ end }}
        
        {{ end }}
        ===== A√á√ïES RECOMENDADAS =====
        1. Verificar o status do servi√ßo imediatamente
        2. Consultar o runbook para procedimentos espec√≠ficos
        3. Escalar para o oncall se necess√°rio
        4. Documentar a√ß√µes tomadas no ticket de incident
        
        ===== LINKS DE MONITORAMENTO =====
        - Prometheus: http://prometheus.company.com/alerts
        - Grafana Dashboard: http://grafana.company.com/d/overview
        - Alertmanager: http://alertmanager.company.com/#/alerts
        - Status Page: http://status.company.com
        
        ===== CONTATOS DE EMERG√äNCIA =====
        - SRE Oncall: +55 11 99999-0001
        - Ops Manager: +55 11 99999-0002
        - Emergency Escalation: +55 11 99999-0000
        
        Este √© um email autom√°tico do sistema de monitoramento cr√≠tico.
        Responda a este email para documentar a√ß√µes tomadas.
      headers:
        Subject: 'üî¥ CRITICAL: {{ .GroupLabels.alertname }}'
        X-Priority: '1'
        X-MSMail-Priority: 'High'
        Importance: 'high'
        X-Mailer: 'Alertmanager Critical'
        Reply-To: 'incident-response@company.com'

# ========================================
# RECEIVERS EMAIL - POR EQUIPE
# ========================================

# SRE Team
sre-notifications-email:
  email_configs:
    - to: '${SRE_EMAIL_LIST:-sre-team@company.com}'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[SRE] {{ .GroupLabels.alertname }} - {{ .GroupLabels.severity }} - {{ .GroupLabels.environment }}'
      body: |
        Alerta para a equipe SRE.
        
        ===== ALERTA SRE =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Inst√¢ncia: {{ .Labels.instance }}
        Servi√ßo: {{ .Labels.service | default "infrastructure" }}
        Ambiente: {{ .Labels.environment | default "unknown" }}
        Categoria: {{ .Labels.category | default "general" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== M√âTRICAS E DASHBOARDS =====
        - Node Exporter: http://grafana.company.com/d/node-exporter
        - Infrastructure Overview: http://grafana.company.com/d/infrastructure
        - Prometheus Targets: http://prometheus.company.com/targets
        
        ===== PROCEDIMENTOS SRE =====
        1. Verificar m√©tricas relacionadas
        2. Analisar logs de sistema
        3. Verificar capacidade e performance
        4. Documentar investiga√ß√£o no runbook
        
        Equipe SRE - Sistema de Monitoramento
      headers:
        Subject: '[SRE] {{ .GroupLabels.alertname }}'
        X-Team: 'SRE'
        X-Environment: '{{ .GroupLabels.environment }}'

# Development Team
dev-notifications-email:
  email_configs:
    - to: '${DEV_EMAIL_LIST:-dev-team@company.com}'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[DEV] {{ .GroupLabels.alertname }} - {{ .GroupLabels.service }} - {{ .GroupLabels.environment }}'
      body: |
        Alerta relacionado a aplica√ß√µes e servi√ßos de desenvolvimento.
        
        ===== ALERTA DE DESENVOLVIMENTO =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Servi√ßo: {{ .Labels.service }}
        Inst√¢ncia: {{ .Labels.instance }}
        Ambiente: {{ .Labels.environment | default "development" }}
        Vers√£o: {{ .Labels.version | default "unknown" }}
        Branch: {{ .Labels.branch | default "main" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== LINKS DE DESENVOLVIMENTO =====
        - Application Logs: http://logs.company.com/{{ .GroupLabels.service }}
        - APM Dashboard: http://apm.company.com/{{ .GroupLabels.service }}
        - CI/CD Pipeline: http://ci.company.com/{{ .GroupLabels.service }}
        - Repository: http://git.company.com/{{ .GroupLabels.service }}
        
        ===== PROCEDIMENTOS DE DEBUG =====
        1. Verificar logs da aplica√ß√£o
        2. Analisar m√©tricas de performance
        3. Verificar √∫ltima deployment
        4. Testar funcionalidade afetada
        5. Rollback se necess√°rio
        
        Equipe de Desenvolvimento - Sistema de Monitoramento
      headers:
        Subject: '[DEV] {{ .GroupLabels.service }} - {{ .GroupLabels.alertname }}'
        X-Team: 'Development'
        X-Service: '{{ .GroupLabels.service }}'

# Network Team
network-notifications-email:
  email_configs:
    - to: '${NETWORK_EMAIL_LIST:-network-team@company.com}'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[NETWORK] {{ .GroupLabels.alertname }} - {{ .GroupLabels.instance }}'
      body: |
        Alerta relacionado √† infraestrutura de rede.
        
        ===== ALERTA DE REDE =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Dispositivo: {{ .Labels.instance }}
        Tipo: {{ .Labels.device_type | default "network-device" }}
        Localiza√ß√£o: {{ .Labels.location | default "unknown" }}
        Vendor: {{ .Labels.vendor | default "unknown" }}
        Modelo: {{ .Labels.model | default "unknown" }}
        Interface: {{ .Labels.ifDescr | default "N/A" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== FERRAMENTAS DE REDE =====
        - Network Monitoring: http://grafana.company.com/d/network-overview
        - SNMP Dashboard: http://grafana.company.com/d/snmp-devices
        - Network Topology: http://netbox.company.com
        - Device Management: http://nms.company.com
        
        ===== PROCEDIMENTOS DE REDE =====
        1. Verificar conectividade: ping {{ .GroupLabels.instance }}
        2. Verificar SNMP: snmpwalk -v2c -c public {{ .GroupLabels.instance }}
        3. Analisar interfaces e utiliza√ß√£o
        4. Verificar logs do dispositivo
        5. Verificar redund√¢ncia e failover
        
        Equipe de Rede - Sistema de Monitoramento
      headers:
        Subject: '[NETWORK] {{ .GroupLabels.instance }} - {{ .GroupLabels.alertname }}'
        X-Team: 'Network'
        X-Device-Type: '{{ .GroupLabels.device_type }}'

# Database Team
database-notifications-email:
  email_configs:
    - to: '${DBA_EMAIL_LIST:-dba-team@company.com}'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[DATABASE] {{ .GroupLabels.alertname }} - {{ .GroupLabels.service }}'
      body: |
        Alerta relacionado a bancos de dados e armazenamento.
        
        ===== ALERTA DE BANCO DE DADOS =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Database: {{ .Labels.service }}
        Inst√¢ncia: {{ .Labels.instance }}
        Tipo: {{ .Labels.db_type | default "unknown" }}
        Vers√£o: {{ .Labels.db_version | default "unknown" }}
        Schema: {{ .Labels.database | default "N/A" }}
        Ambiente: {{ .Labels.environment | default "unknown" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== FERRAMENTAS DE DATABASE =====
        - Database Dashboard: http://grafana.company.com/d/database-overview
        - Performance Metrics: http://grafana.company.com/d/db-performance
        - Query Analytics: http://grafana.company.com/d/slow-queries
        - Backup Status: http://backup.company.com/status
        
        ===== PROCEDIMENTOS DBA =====
        1. Verificar conex√µes ativas
        2. Analisar queries lentas
        3. Verificar espa√ßo em disco
        4. Analisar logs de erro
        5. Verificar replica√ß√£o (se aplic√°vel)
        6. Verificar status de backup
        
        Equipe DBA - Sistema de Monitoramento
      headers:
        Subject: '[DBA] {{ .GroupLabels.service }} - {{ .GroupLabels.alertname }}'
        X-Team: 'DBA'
        X-Database-Type: '{{ .GroupLabels.db_type }}'

# Security Team
security-notifications-email:
  email_configs:
    - to: '${SECURITY_EMAIL_LIST:-security-team@company.com}'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[SECURITY] {{ .GroupLabels.alertname }} - {{ .GroupLabels.severity }}'
      body: |
        ‚ö†Ô∏è  ALERTA DE SEGURAN√áA ‚ö†Ô∏è
        
        Um evento de seguran√ßa foi detectado e requer an√°lise.
        
        ===== ALERTA DE SEGURAN√áA =====
        {{ range .Alerts }}
        üîí Alert: {{ .Annotations.summary }}
        üìù Descri√ß√£o: {{ .Annotations.description }}
        üö® Severidade: {{ .Labels.severity | upper }}
        üñ•Ô∏è  Inst√¢ncia: {{ .Labels.instance }}
        üîß Servi√ßo: {{ .Labels.service | default "N/A" }}
        üåç Ambiente: {{ .Labels.environment | default "unknown" }}
        üìç Localiza√ß√£o: {{ .Labels.location | default "unknown" }}
        üïê Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Labels.source_ip }}
        üåê IP de Origem: {{ .Labels.source_ip }}
        {{ end }}
        {{ if .Labels.user }}
        üë§ Usu√°rio: {{ .Labels.user }}
        {{ end }}
        {{ if .Annotations.runbook_url }}
        üìñ Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== FERRAMENTAS DE SEGURAN√áA =====
        - SIEM Dashboard: http://siem.company.com
        - Security Metrics: http://grafana.company.com/d/security
        - Threat Intelligence: http://threat.company.com
        - Incident Response: http://incident.company.com
        
        ===== PROCEDIMENTOS DE SEGURAN√áA =====
        1. Analisar logs de seguran√ßa
        2. Verificar indicadores de comprometimento
        3. Correlacionar com threat intelligence
        4. Documentar no sistema de incidents
        5. Escalar conforme pol√≠tica de seguran√ßa
        
        ‚ö†Ô∏è  CONFIDENCIAL - EQUIPE DE SEGURAN√áA ‚ö†Ô∏è
        Este email cont√©m informa√ß√µes sens√≠veis de seguran√ßa.
      headers:
        Subject: '[SECURITY] {{ .GroupLabels.alertname }}'
        X-Priority: '1'
        X-Team: 'Security'
        X-Classification: 'Confidential'

# ========================================
# RECEIVERS EMAIL - POR AMBIENTE
# ========================================

# Produ√ß√£o
production-alerts-email:
  email_configs:
    - to: 'production-alerts@company.com,ops-manager@company.com'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[PROD] {{ .GroupLabels.alertname }} - {{ .GroupLabels.service }}'
      body: |
        üè≠ ALERTA DE PRODU√á√ÉO üè≠
        
        Um alerta foi disparado no ambiente de produ√ß√£o.
        
        ===== DETALHES DO ALERTA =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Prioridade: {{ .Labels.priority | default "P2" }}
        Servi√ßo: {{ .Labels.service }}
        Inst√¢ncia: {{ .Labels.instance }}
        Vers√£o: {{ .Labels.version | default "unknown" }}
        Cluster: {{ .Labels.cluster | default "main" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        {{ if .Annotations.runbook_url }}
        Runbook: {{ .Annotations.runbook_url }}
        {{ end }}
        
        {{ end }}
        ===== IMPACTO NO NEG√ìCIO =====
        - Ambiente: PRODU√á√ÉO
        - Criticidade: ALTA
        - SLA Impact: Poss√≠vel
        - Customer Impact: {{ if eq .GroupLabels.severity "critical" }}ALTO{{ else }}BAIXO{{ end }}
        
        ===== A√á√ïES IMEDIATAS =====
        1. Verificar status do servi√ßo
        2. Analisar impacto nos usu√°rios
        3. Seguir procedimentos de incident response
        4. Comunicar stakeholders se necess√°rio
        
        üè≠ AMBIENTE DE PRODU√á√ÉO - ATEN√á√ÉO REDOBRADA üè≠
      headers:
        Subject: '[PROD] {{ .GroupLabels.service }} - {{ .GroupLabels.alertname }}'
        X-Priority: '2'
        X-Environment: 'Production'
        X-Business-Impact: '{{ if eq .GroupLabels.severity "critical" }}High{{ else }}Low{{ end }}'

# Staging
staging-alerts-email:
  email_configs:
    - to: 'staging-alerts@company.com,qa-team@company.com'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[STAGING] {{ .GroupLabels.alertname }} - {{ .GroupLabels.service }}'
      body: |
        üß™ ALERTA DE STAGING üß™
        
        ===== ALERTA DE STAGING =====
        {{ range .Alerts }}
        Alert: {{ .Annotations.summary }}
        Descri√ß√£o: {{ .Annotations.description }}
        Severidade: {{ .Labels.severity | upper }}
        Servi√ßo: {{ .Labels.service }}
        Inst√¢ncia: {{ .Labels.instance }}
        Branch: {{ .Labels.branch | default "develop" }}
        Build: {{ .Labels.build | default "unknown" }}
        Iniciado em: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        
        {{ end }}
        ===== AMBIENTE DE TESTE =====
        - Ambiente: STAGING
        - Prop√≥sito: Testes e valida√ß√£o
        - Impact: Limitado ao ambiente de teste
        
        Equipe QA - Sistema de Monitoramento
      headers:
        Subject: '[STAGING] {{ .GroupLabels.alertname }}'
        X-Environment: 'Staging'
        X-Priority: '3'

# ========================================
# RECEIVERS EMAIL - ESPECIAIS
# ========================================

# Heartbeat/Watchdog
monitoring-heartbeat-email:
  email_configs:
    - to: 'monitoring-team@company.com'
      from: '${SMTP_FROM:-alertmanager@company.com}'
      subject: '[HEARTBEAT] Alertmanager Status - {{ .StartsAt.Format "2006-01-02 15:04" }}'
      body: |
        Sistema de Monitoramento - Heartbeat
        
        ===== STATUS DO ALERTMANAGER =====
        Timestamp: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
        Status: Funcionando normalmente
        
        ===== COMPONENTES MONITORADOS =====
        - Prometheus: Ativo
        - Alertmanager: Ativo
        - Grafana: Ativo
        - Exporters: Verificar dashboard
        
        Este √© um email autom√°tico de verifica√ß√£o do sistema.
      headers:
        Subject: '[HEARTBEAT] Alertmanager OK'
        X-Type: 'Heartbeat'
        X-Priority: '5'

# ============================================================================
# CONFIGURA√á√ÉO DE TEMPLATES EMAIL
# ============================================================================
#
# 1. VARI√ÅVEIS DISPON√çVEIS:
#    - .GroupLabels: Labels agrupados
#    - .CommonLabels: Labels comuns
#    - .CommonAnnotations: Annotations comuns
#    - .Alerts: Array de alertas
#    - .Status: Status (firing/resolved)
#    - .Receiver: Nome do receiver
#
# 2. FUN√á√ïES DE TEMPLATE:
#    - .StartsAt.Format "layout": Formata√ß√£o de data
#    - .StartsAt | since: Dura√ß√£o desde o in√≠cio
#    - .Labels.label | default "valor": Valor padr√£o
#    - .Labels.label | upper: Mai√∫sculo
#    - .Labels.label | lower: Min√∫sculo
#
# 3. HEADERS RECOMENDADOS:
#    - X-Priority: 1 (high), 3 (normal), 5 (low)
#    - X-Team: Nome da equipe
#    - X-Environment: Ambiente
#    - X-Service: Servi√ßo
#    - Reply-To: Email para respostas
#    - X-Mailer: Identifica√ß√£o do sistema
#
# 4. FORMATA√á√ÉO DE EMAIL:
#    - Use texto simples para compatibilidade
#    - Estruture com se√ß√µes claras
#    - Inclua links √∫teis
#    - Adicione procedimentos de a√ß√£o
#    - Use emojis com modera√ß√£o
#
# 5. CONFIGURA√á√ÉO SMTP:
#    - Configure TLS/SSL adequadamente
#    - Use autentica√ß√£o segura
#    - Configure timeouts apropriados
#    - Teste entrega regularmente
#
# 6. LISTAS DE EMAIL:
#    - Use vari√°veis de ambiente
#    - Mantenha listas atualizadas
#    - Configure aliases por equipe
#    - Documente responsabilidades
#
# 7. TESTE E VALIDA√á√ÉO:
#    - Teste templates com dados reais
#    - Verifique formata√ß√£o em diferentes clientes
#    - Valide entrega e recebimento
#    - Configure filtros anti-spam
# ============================================================================